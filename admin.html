<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê´€ë¦¬ì</title>

<style>
body{
font-family:Arial;
background:#f5f6fa;
padding:40px;
}

h2{
margin-top:40px;
}

input,select{
padding:10px;
margin:5px 0;
width:260px;
}

button{
padding:8px 14px;
cursor:pointer;
margin-left:5px;
}

.row{
background:white;
padding:10px;
margin:5px 0;
border-radius:8px;
display:flex;
justify-content:space-between;
align-items:center;
}

</style>
</head>
<body>

<h1>ê´€ë¦¬ì</h1>

<h2>ì¹´í…Œê³ ë¦¬ ì¶”ê°€</h2>
<input id="catName" placeholder="ì¹´í…Œê³ ë¦¬ ì´ë¦„">
<button onclick="addCategory()">ì¶”ê°€</button>

<div id="catList"></div>

<h2>ì¹´ë“œ ì¶”ê°€</h2>

<input id="title" placeholder="ì´ë¦„"><br>
<input id="url" placeholder="URL"><br>
<input id="icon" placeholder="ì•„ì´ì½˜ (ì˜ˆ: ğŸ“Š)"><br>

<select id="category"></select>
<button onclick="addCard()">ìƒì„±</button>

<div id="cardList"></div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyBzlQt0DyUdA7W3s7qzYjis6UUFA1b4RjqA",
authDomain: "open-7d88e.firebaseapp.com",
projectId: "open-7d88e",
storageBucket: "open-7d88e.firebasestorage.app",
messagingSenderId: "359782434518",
appId: "1:359782434518:web:22ba4a6bfc5b21a446b77"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.addCategory = async function(){

const name=document.getElementById("catName").value;

await addDoc(collection(db,"categories"),{name});

load();

}

window.addCard = async function(){

const title=document.getElementById("title").value;
const url=document.getElementById("url").value;
const icon=document.getElementById("icon").value;
const category=document.getElementById("category").value;

await addDoc(collection(db,"cards"),{
title,url,icon,category
});

load();

}

async function load(){

const catList=document.getElementById("catList");
const catSelect=document.getElementById("category");
const cardList=document.getElementById("cardList");

catList.innerHTML="";
catSelect.innerHTML="";
cardList.innerHTML="";

const catSnap=await getDocs(collection(db,"categories"));
const cardSnap=await getDocs(collection(db,"cards"));

const cats=[];
catSnap.forEach(d=>cats.push({id:d.id,...d.data()}));

cats.forEach(c=>{

const row=document.createElement("div");
row.className="row";
row.innerHTML=`
<div>${c.name}</div>
<button onclick="deleteCategory('${c.id}')">ì‚­ì œ</button>
`;
catList.appendChild(row);

const opt=document.createElement("option");
opt.value=c.name;
opt.innerText=c.name;
catSelect.appendChild(opt);

});

const cards=[];
cardSnap.forEach(d=>cards.push({id:d.id,...d.data()}));

cards.forEach(c=>{

const row=document.createElement("div");
row.className="row";
row.innerHTML=`
<div>${c.title} (${c.category})</div>
<button onclick="deleteCard('${c.id}')">ì‚­ì œ</button>
`;
cardList.appendChild(row);

});

}

window.deleteCategory = async function(id){
await deleteDoc(doc(db,"categories",id));
load();
}

window.deleteCard = async function(id){
await deleteDoc(doc(db,"cards",id));
load();
}

load();

</script>

</body>
</html>
