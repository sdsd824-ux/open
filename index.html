<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>업무 포털</title>

<style>

body{
font-family:Arial;
background:#f4f6fb;
margin:0;
padding:40px;
}

.container{
max-width:1200px;
margin:auto;
}

h1{
text-align:center;
font-size:42px;
margin-bottom:10px;
}

.sub{
text-align:center;
margin-bottom:40px;
color:#666;
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:20px;
}

.leftTop{
display:flex;
gap:10px;
align-items:center;
}

.search{
width:260px;
padding:10px;
font-size:16px;
border-radius:8px;
border:1px solid #ccc;
}

.user{
color:#555;
}

.loginBtn{
padding:10px 18px;
border:none;
background:#222;
color:white;
border-radius:8px;
cursor:pointer;
}

.categories{
margin-bottom:20px;
}

.catBtn{
border:none;
background:#e7ebf4;
padding:8px 14px;
border-radius:8px;
margin-right:6px;
cursor:pointer;
}

.catActive{
background:#4c7cff;
color:white;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:20px;
}

.card{
background:white;
border-radius:14px;
padding:25px;
text-align:center;
cursor:pointer;
position:relative;
box-shadow:0 4px 12px rgba(0,0,0,0.06);
transition:.15s;
}

.card:hover{
transform:translateY(-4px);
}

.icon{
width:36px;
height:36px;
margin-bottom:10px;
}

.star{
position:absolute;
top:10px;
right:12px;
font-size:18px;
cursor:pointer;
}

.edit{
position:absolute;
left:10px;
top:10px;
font-size:16px;
cursor:pointer;
}

.category{
font-size:12px;
color:#777;
margin-top:4px;
}

.admin{
margin-top:30px;
text-align:center;
}

.addBtn{
padding:12px 20px;
border:none;
background:#4c7cff;
color:white;
border-radius:8px;
cursor:pointer;
margin:5px;
}

.modal{
position:fixed;
top:0;
left:0;
right:0;
bottom:0;
background:rgba(0,0,0,0.3);
display:none;
align-items:center;
justify-content:center;
}

.modalBox{
background:white;
padding:25px;
border-radius:10px;
width:350px;
}

.modalBox input{
width:100%;
padding:8px;
margin-bottom:10px;
}

</style>
</head>

<body>

<div class="container">

<h1>업무 포털</h1>
<div class="sub">자주 사용하는 사이트</div>

<div class="topbar">

<div class="leftTop">
<input class="search" placeholder="검색" id="search">
<div class="user" id="userLabel"></div>
</div>

<button class="loginBtn" onclick="login()">로그인</button>

</div>

<div id="categories" class="categories"></div>

<div id="grid" class="grid"></div>

<div class="admin" id="adminPanel" style="display:none">
<button class="addBtn" onclick="openAdd()">사이트 추가</button>
<button class="addBtn" onclick="manageCategories()">카테고리 관리</button>
</div>

</div>


<div class="modal" id="modal">
<div class="modalBox">

<input id="m_name" placeholder="사이트 이름">
<input id="m_url" placeholder="URL">
<input id="m_cat" placeholder="카테고리">
<input id="m_icon" placeholder="아이콘 URL or emoji">

<button onclick="saveSite()">저장</button>
<button onclick="deleteSite()">삭제</button>

</div>
</div>

<script>

let currentUser=localStorage.getItem("portal_user") || ""
let isAdmin=false

if(currentUser==="김윤식") isAdmin=true

document.getElementById("userLabel").innerText=currentUser?`사용자 : ${currentUser}`:""

let defaultSites=[
{
name:"환자 내원 분석",
url:"https://sdsd824-ux.github.io/visitrate/",
icon:"auto",
category:"업무"
}
]

let sites=JSON.parse(localStorage.getItem("portal_sites")||"null") || defaultSites

sites=sites.filter(s=>s && s.name && s.url)

let favorites=JSON.parse(localStorage.getItem("fav_"+currentUser)||"[]")

let categories=JSON.parse(localStorage.getItem("portal_categories")||"null") || ["전체","업무"]

let selectedCategory="전체"

let editing=null


function renderCategories(){

let box=document.getElementById("categories")
box.innerHTML=""

categories.forEach(cat=>{

let btn=document.createElement("button")
btn.className="catBtn"

if(cat===selectedCategory) btn.classList.add("catActive")

btn.innerText=cat

btn.onclick=()=>{
selectedCategory=cat
render()
}

box.appendChild(btn)

})

}

function render(){

renderCategories()

let grid=document.getElementById("grid")
grid.innerHTML=""

let keyword=document.getElementById("search").value.toLowerCase()

let sorted=[...sites].sort((a,b)=>{

let af=favorites.includes(a.url)?0:1
let bf=favorites.includes(b.url)?0:1

return af-bf

})

sorted.forEach(site=>{

if(selectedCategory!=="전체" && site.category!==selectedCategory) return

if(keyword && !site.name.toLowerCase().includes(keyword)) return

let icon=site.icon==="auto"
?`https://www.google.com/s2/favicons?sz=64&domain_url=${site.url}`
:site.icon

let star=favorites.includes(site.url)?"★":"☆"

let card=document.createElement("div")
card.className="card"

card.innerHTML=`

${isAdmin?'<div class="edit">⚙</div>':''}
<div class="star">${star}</div>
<img class="icon" src="${icon}">
<div><b>${site.name}</b></div>
<div class="category">${site.category}</div>

`

card.onclick=()=>window.open(site.url,"_blank")

card.querySelector(".star").onclick=(e)=>{
e.stopPropagation()
toggleFav(site.url)
}

if(isAdmin){

card.querySelector(".edit").onclick=(e)=>{
e.stopPropagation()
edit(site)
}

}

grid.appendChild(card)

})

document.getElementById("adminPanel").style.display=isAdmin?"block":"none"

}

function toggleFav(url){

if(favorites.includes(url))
favorites=favorites.filter(f=>f!==url)
else
favorites.push(url)

localStorage.setItem("fav_"+currentUser,JSON.stringify(favorites))

render()

}

function login(){

let name=prompt("이름")

if(!name) return

if(name==="김윤식"){

let pass=prompt("관리자 비밀번호")

if(pass!=="진설김윤식"){
alert("틀림")
return
}

isAdmin=true

}

currentUser=name
localStorage.setItem("portal_user",name)

favorites=JSON.parse(localStorage.getItem("fav_"+currentUser)||"[]")

location.reload()

}

function openAdd(){

editing=null

document.getElementById("modal").style.display="flex"

}

function edit(site){

editing=site

m_name.value=site.name
m_url.value=site.url
m_cat.value=site.category
m_icon.value=site.icon

modal.style.display="flex"

}

function saveSite(){

let name=m_name.value
let url=m_url.value
let cat=m_cat.value
let icon=m_icon.value||"auto"

if(!name||!url) return

if(editing){

editing.name=name
editing.url=url
editing.category=cat
editing.icon=icon

}else{

sites.push({name,url,category:cat,icon})

}

if(!categories.includes(cat)) categories.push(cat)

localStorage.setItem("portal_sites",JSON.stringify(sites))
localStorage.setItem("portal_categories",JSON.stringify(categories))

modal.style.display="none"

render()

}

function deleteSite(){

if(!editing) return

sites=sites.filter(s=>s!==editing)

localStorage.setItem("portal_sites",JSON.stringify(sites))

modal.style.display="none"

render()

}

function manageCategories(){

let name=prompt("카테고리 추가")

if(name){

categories.push(name)
localStorage.setItem("portal_categories",JSON.stringify(categories))

render()

}

}

search.addEventListener("input",render)

render()

</script>

</body>
</html>
