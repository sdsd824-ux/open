<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>업무 포털</title>

<style>

body{
font-family:Arial;
background:#f4f6fb;
margin:0;
padding:40px;
}

.container{
max-width:1200px;
margin:auto;
}

h1{
text-align:center;
font-size:42px;
margin-bottom:10px;
}

.sub{
text-align:center;
margin-bottom:30px;
color:#666;
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:20px;
}

.user{
font-size:14px;
color:#555;
}

.search{
width:280px;
padding:10px;
font-size:15px;
border-radius:8px;
border:1px solid #ccc;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:20px;
}

.card{
background:white;
border-radius:14px;
padding:25px;
text-align:center;
cursor:pointer;
position:relative;
box-shadow:0 4px 12px rgba(0,0,0,0.06);
transition:.15s;
}

.card:hover{
transform:translateY(-4px);
}

.icon{
width:38px;
height:38px;
margin-bottom:10px;
}

.star{
position:absolute;
top:10px;
right:12px;
font-size:18px;
cursor:pointer;
}

.category{
font-size:12px;
color:#888;
margin-top:4px;
}

</style>
</head>

<body>

<div class="container">

<h1>업무 포털</h1>
<div class="sub">자주 사용하는 사이트</div>

<div class="topbar">
<input class="search" placeholder="검색" id="search">
<div class="user" id="userBox"></div>
</div>

<div id="grid" class="grid"></div>

</div>

<script>

let currentUser=localStorage.getItem("portal_user")

if(!currentUser){
currentUser=prompt("이름 입력")
localStorage.setItem("portal_user",currentUser)
}

document.getElementById("userBox").innerText="사용자 : "+currentUser

let defaultSites=[
{
name:"환자 내원 분석",
url:"https://sdsd824-ux.github.io/visitrate/",
category:"업무",
icon:"auto"
}
]

let sites=JSON.parse(localStorage.getItem("portal_sites")||"null") || defaultSites

let favorites=JSON.parse(localStorage.getItem("fav_"+currentUser)||"[]")

function render(){

let keyword=document.getElementById("search").value.toLowerCase()

let grid=document.getElementById("grid")
grid.innerHTML=""

let sorted=[...sites].sort((a,b)=>{
let af=favorites.includes(a.url)?0:1
let bf=favorites.includes(b.url)?0:1
return af-bf
})

sorted.forEach(site=>{

if(keyword && !site.name.toLowerCase().includes(keyword)) return

let card=document.createElement("div")
card.className="card"

let icon=""

if(site.icon==="auto"){
icon=`https://www.google.com/s2/favicons?sz=64&domain_url=${site.url}`
}else{
icon=site.icon
}

let star=favorites.includes(site.url)?"★":"☆"

card.innerHTML=`
<div class="star">${star}</div>
<img class="icon" src="${icon}">
<div><b>${site.name}</b></div>
<div class="category">${site.category||""}</div>
`

card.onclick=()=>window.open(site.url,"_blank")

card.querySelector(".star").onclick=(e)=>{
e.stopPropagation()
toggleFav(site.url)
}

grid.appendChild(card)

})

}

function toggleFav(url){

if(favorites.includes(url)){
favorites=favorites.filter(f=>f!==url)
}else{
favorites.push(url)
}

localStorage.setItem("fav_"+currentUser,JSON.stringify(favorites))
render()

}

document.getElementById("search").addEventListener("input",render)

render()

</script>

</body>
</html>
