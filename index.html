<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì—…ë¬´ í¬í„¸</title>

<style>

body{
font-family:Arial;
background:#f4f6fb;
margin:0;
padding:40px;
}

.container{
max-width:1200px;
margin:auto;
}

h1{
text-align:center;
font-size:42px;
margin-bottom:5px;
}

.sub{
text-align:center;
margin-bottom:25px;
color:#666;
}

.user{
text-align:center;
margin-bottom:20px;
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:20px;
}

.search{
width:300px;
padding:10px;
font-size:16px;
border-radius:8px;
border:1px solid #ccc;
}

.loginBtn{
padding:10px 18px;
border:none;
background:#222;
color:white;
border-radius:8px;
cursor:pointer;
}

.categories{
margin-bottom:20px;
}

.catBtn{
border:none;
background:#e6e9f2;
padding:8px 14px;
border-radius:8px;
margin-right:6px;
cursor:pointer;
}

.catActive{
background:#4c7cff;
color:white;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:20px;
}

.card{
background:white;
border-radius:14px;
padding:25px;
text-align:center;
cursor:pointer;
position:relative;
box-shadow:0 4px 12px rgba(0,0,0,0.06);
}

.icon{
font-size:28px;
margin-bottom:10px;
}

.star{
position:absolute;
top:10px;
right:12px;
font-size:18px;
cursor:pointer;
}

.edit{
position:absolute;
top:10px;
left:12px;
font-size:14px;
cursor:pointer;
display:none;
}

.card:hover .edit{
display:block;
}

.admin{
margin-top:30px;
text-align:center;
}

button{
cursor:pointer;
}

.manager button{
margin:4px;
padding:8px 12px;
}

.editor{
background:white;
padding:20px;
border-radius:10px;
margin-bottom:20px;
display:none;
}

.editor input,
.editor select{
width:100%;
padding:10px;
margin-bottom:10px;
}

.iconSelect span{
font-size:22px;
margin:4px;
cursor:pointer;
}

.iconActive{
background:#ddd;
border-radius:6px;
}

</style>
</head>

<body>

<div class="container">

<h1>ì—…ë¬´ í¬í„¸</h1>
<div class="sub">ìì£¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ì´íŠ¸</div>
<div class="user" id="userText"></div>

<div class="topbar">
<input class="search" placeholder="ê²€ìƒ‰" id="search">
<button class="loginBtn" onclick="login()">ë¡œê·¸ì¸</button>
</div>

<div id="editor" class="editor">

<input id="siteName" placeholder="ì‚¬ì´íŠ¸ ì´ë¦„">
<input id="siteUrl" placeholder="ì‚¬ì´íŠ¸ URL">

<select id="siteCategory"></select>

<div class="iconSelect" id="iconSelect"></div>

<button onclick="saveSite()">ì €ì¥</button>
<button onclick="deleteSite()">ì‚­ì œ</button>

</div>

<div class="categories" id="cats"></div>

<div id="grid" class="grid"></div>

<div class="admin manager" id="adminPanel" style="display:none">
<button onclick="openAdd()">ì‚¬ì´íŠ¸ ì¶”ê°€</button>
<button onclick="addCategory()">ì¹´í…Œê³ ë¦¬ ì¶”ê°€</button>
<button onclick="editCategory()">ì¹´í…Œê³ ë¦¬ ìˆ˜ì •</button>
<button onclick="deleteCategory()">ì¹´í…Œê³ ë¦¬ ì‚­ì œ</button>
</div>

</div>

<script>

let user=localStorage.getItem("user") || ""
let admin=false

if(user==="ê¹€ìœ¤ì‹") admin=true

document.getElementById("userText").innerText=user?`ì‚¬ìš©ì : ${user}`:""

if(admin) document.getElementById("adminPanel").style.display="block"

let icons=["ğŸ“Š","ğŸ“","ğŸ“…","ğŸ“","ğŸ§¾","ğŸ“ˆ","ğŸ’¬","ğŸŒ","ğŸ–¥","ğŸ§ ","ğŸ“Œ","ğŸ”"]

let data=JSON.parse(localStorage.getItem("portal_data")||"null")

if(!data){

data={
categories:["ì „ì²´","ë¶„ì„"],
sites:[
{
name:"í™˜ì ë‚´ì› ë¶„ì„",
url:"https://sdsd824-ux.github.io/visitrate/",
icon:"ğŸ“Š",
category:"ë¶„ì„"
}
]
}

save()

}

let favorites=JSON.parse(localStorage.getItem("fav_"+user)||"[]")

let selectedCategory="ì „ì²´"
let editingIndex=null
let selectedIcon="ğŸ“Š"

function save(){
localStorage.setItem("portal_data",JSON.stringify(data))
}

function renderCats(){

let el=document.getElementById("cats")
el.innerHTML=""

data.categories.forEach(cat=>{

let b=document.createElement("button")
b.className="catBtn"+(cat===selectedCategory?" catActive":"")

b.innerText=cat

b.onclick=()=>{
selectedCategory=cat
render()
}

el.appendChild(b)

})

}

function render(){

renderCats()

let grid=document.getElementById("grid")
grid.innerHTML=""

let keyword=document.getElementById("search").value.toLowerCase()

data.sites.forEach((site,i)=>{

if(selectedCategory!=="ì „ì²´" && site.category!==selectedCategory) return

if(keyword && !site.name.toLowerCase().includes(keyword)) return

let card=document.createElement("div")
card.className="card"

let star=favorites.includes(site.url)?"â˜…":"â˜†"

card.innerHTML=`
<div class="edit" onclick="editSite(${i})">ìˆ˜ì •</div>
<div class="star">${star}</div>
<div class="icon">${site.icon}</div>
<div><b>${site.name}</b></div>
`

card.onclick=()=>window.open(site.url)

card.querySelector(".star").onclick=(e)=>{
e.stopPropagation()
toggleFav(site.url)
}

grid.appendChild(card)

})

}

function toggleFav(url){

if(favorites.includes(url)){
favorites=favorites.filter(f=>f!==url)
}else{
favorites.push(url)
}

localStorage.setItem("fav_"+user,JSON.stringify(favorites))

render()

}

function login(){

let name=prompt("ì´ë¦„")

if(!name) return

localStorage.setItem("user",name)

location.reload()

}

function openAdd(){

editingIndex=null

document.getElementById("editor").style.display="block"

document.getElementById("siteName").value=""
document.getElementById("siteUrl").value=""

}

function editSite(i){

if(!admin) return

editingIndex=i

let s=data.sites[i]

document.getElementById("editor").style.display="block"

document.getElementById("siteName").value=s.name
document.getElementById("siteUrl").value=s.url
document.getElementById("siteCategory").value=s.category

selectedIcon=s.icon

highlightIcon()

}

function saveSite(){

let name=document.getElementById("siteName").value
let url=document.getElementById("siteUrl").value
let cat=document.getElementById("siteCategory").value

let obj={
name,
url,
icon:selectedIcon,
category:cat
}

if(editingIndex===null){

data.sites.push(obj)

}else{

data.sites[editingIndex]=obj

}

save()
render()

document.getElementById("editor").style.display="none"

}

function deleteSite(){

if(editingIndex===null) return

data.sites.splice(editingIndex,1)

save()
render()

document.getElementById("editor").style.display="none"

}

function addCategory(){

let name=prompt("ì¹´í…Œê³ ë¦¬ ì´ë¦„")

if(!name) return

data.categories.push(name)

save()
render()

updateCategorySelect()

}

function editCategory(){

let old=prompt("ê¸°ì¡´ ì´ë¦„")

let nw=prompt("ìƒˆ ì´ë¦„")

data.categories=data.categories.map(c=>c===old?nw:c)

save()
render()
updateCategorySelect()

}

function deleteCategory(){

let name=prompt("ì‚­ì œí•  ì¹´í…Œê³ ë¦¬")

data.categories=data.categories.filter(c=>c!==name)

save()
render()
updateCategorySelect()

}

function updateCategorySelect(){

let sel=document.getElementById("siteCategory")

sel.innerHTML=""

data.categories.forEach(c=>{

let o=document.createElement("option")
o.value=c
o.textContent=c

sel.appendChild(o)

})

}

function renderIcons(){

let wrap=document.getElementById("iconSelect")

icons.forEach(i=>{

let s=document.createElement("span")

s.innerText=i

s.onclick=()=>{

selectedIcon=i
highlightIcon()

}

wrap.appendChild(s)

})

}

function highlightIcon(){

document.querySelectorAll("#iconSelect span").forEach(s=>{

s.classList.remove("iconActive")

if(s.innerText===selectedIcon){

s.classList.add("iconActive")

}

})

}

document.getElementById("search").addEventListener("input",render)

renderIcons()
updateCategorySelect()
render()

</script>

</body>
</html>
