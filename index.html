<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì—…ë¬´ í¬í„¸</title>

<style>

body{
font-family:Arial;
background:#f5f6f8;
margin:0;
}

header{
text-align:center;
padding:30px;
}

h1{
margin:0;
}

.topbar{
position:absolute;
right:30px;
top:30px;
}

.container{
max-width:1200px;
margin:auto;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
gap:15px;
padding:20px;
}

.card{
background:white;
border-radius:12px;
padding:20px;
text-align:center;
cursor:grab;
box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

.card:hover{
transform:translateY(-3px);
}

.icon{
font-size:28px;
margin-bottom:8px;
}

button{
cursor:pointer;
}

.admin{
margin:10px;
text-align:center;
}

.modal{
position:fixed;
background:rgba(0,0,0,0.4);
left:0;
right:0;
top:0;
bottom:0;
display:none;
align-items:center;
justify-content:center;
}

.modal-box{
background:white;
padding:20px;
border-radius:10px;
width:300px;
}

.modal input, .modal select{
width:100%;
margin-bottom:10px;
padding:6px;
}

.icon-picker{
display:flex;
flex-wrap:wrap;
gap:6px;
margin-bottom:10px;
}

.icon-picker span{
border:1px solid #ddd;
padding:6px;
border-radius:6px;
cursor:pointer;
}

</style>
</head>

<body>

<header>
<h1>ì—…ë¬´ í¬í„¸</h1>
<div id="userArea"></div>
</header>

<div class="admin">
<button onclick="openModal()">ì‚¬ì´íŠ¸ ì¶”ê°€</button>
<button onclick="addCategory()">ì¹´í…Œê³ ë¦¬ ì¶”ê°€</button>
<button onclick="editCategory()">ì¹´í…Œê³ ë¦¬ ìˆ˜ì •</button>
<button onclick="deleteCategory()">ì¹´í…Œê³ ë¦¬ ì‚­ì œ</button>
</div>

<div class="container">
<div id="grid" class="grid"></div>
</div>


<div class="modal" id="modal">
<div class="modal-box">

<input id="name" placeholder="ì‚¬ì´íŠ¸ ì´ë¦„">
<input id="url" placeholder="URL">

<select id="category"></select>

<input id="icon" placeholder="ì•„ì´ì½˜">

<div class="icon-picker">
<span>ğŸ“Š</span>
<span>ğŸ“</span>
<span>ğŸ“…</span>
<span>ğŸ“Œ</span>
<span>ğŸ’»</span>
<span>ğŸ§¾</span>
<span>ğŸ“ˆ</span>
<span>â­</span>
<span>ğŸ”</span>
</div>

<button onclick="saveSite()">ì €ì¥</button>
<button onclick="closeModal()">ë‹«ê¸°</button>

</div>
</div>


<script>

let admin = true

let data = JSON.parse(localStorage.getItem("portalData")) || {
categories:{
ì—…ë¬´:[],
ë¶„ì„:[]
}
}

function save(){
localStorage.setItem("portalData",JSON.stringify(data))
}

function render(){

const grid=document.getElementById("grid")
grid.innerHTML=""

for(const cat in data.categories){

data.categories[cat].forEach((site,i)=>{

const card=document.createElement("div")
card.className="card"
card.draggable=true

card.innerHTML=
`
<div class="icon">${site.icon || "ğŸŒ"}</div>
<div>${site.name}</div>
`

card.onclick=()=>window.open(site.url)

if(admin){

card.oncontextmenu=(e)=>{
e.preventDefault()
if(confirm("ì‚­ì œ?")){
data.categories[cat].splice(i,1)
save()
render()
}
}

}

card.addEventListener("dragstart",dragStart)
card.dataset.cat=cat
card.dataset.index=i

grid.appendChild(card)

})

}

updateCategorySelect()

}

function updateCategorySelect(){

const sel=document.getElementById("category")
sel.innerHTML=""

for(const c in data.categories){

const op=document.createElement("option")
op.value=c
op.textContent=c
sel.appendChild(op)

}

}

function openModal(){
document.getElementById("modal").style.display="flex"
}

function closeModal(){
document.getElementById("modal").style.display="none"
}

function saveSite(){

const name=document.getElementById("name").value
const url=document.getElementById("url").value
const cat=document.getElementById("category").value
const icon=document.getElementById("icon").value

if(!name || !url) return alert("ì…ë ¥")

data.categories[cat].push({
name,url,icon
})

save()
render()
closeModal()

}

function addCategory(){

const name=prompt("ì¹´í…Œê³ ë¦¬ ì´ë¦„")

if(!name) return

data.categories[name]=[]

save()
render()

}

function editCategory(){

const old=prompt("ê¸°ì¡´ ì¹´í…Œê³ ë¦¬")

if(!data.categories[old]) return

const newName=prompt("ìƒˆ ì´ë¦„",old)

data.categories[newName]=data.categories[old]
delete data.categories[old]

save()
render()

}

function deleteCategory(){

const name=prompt("ì‚­ì œí•  ì¹´í…Œê³ ë¦¬")

if(!data.categories[name]) return

delete data.categories[name]

save()
render()

}

let dragItem=null

function dragStart(){
dragItem=this
}

document.addEventListener("dragover",e=>e.preventDefault())

document.addEventListener("drop",function(e){

const target=e.target.closest(".card")

if(!target || dragItem===target) return

const fromCat=dragItem.dataset.cat
const fromIndex=dragItem.dataset.index

const toCat=target.dataset.cat
const toIndex=target.dataset.index

const item=data.categories[fromCat][fromIndex]

data.categories[fromCat].splice(fromIndex,1)
data.categories[toCat].splice(toIndex,0,item)

save()
render()

})

document.querySelectorAll(".icon-picker span").forEach(el=>{
el.onclick=()=>{
document.getElementById("icon").value=el.textContent
}
})

function login(){

const name=prompt("ì´ë¦„")

if(!name) return

localStorage.setItem("user",name)
showUser()

}

function showUser(){

const u=localStorage.getItem("user")

if(!u){

document.getElementById("userArea").innerHTML=
`<button onclick="login()">ë¡œê·¸ì¸</button>`

}else{

document.getElementById("userArea").innerHTML=
`ì‚¬ìš©ì : ${u}`

}

}

showUser()
render()

</script>

</body>
</html>
