<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ÏóÖÎ¨¥ Ìè¨ÌÑ∏</title>

<style>

body{
font-family:Arial;
background:#f4f6fb;
margin:0;
padding:40px;
}

.container{
max-width:1200px;
margin:auto;
}

h1{
text-align:center;
font-size:42px;
margin-bottom:20px;
}

.user{
text-align:right;
margin-bottom:10px;
color:#555;
}

.topbar{
display:flex;
gap:10px;
margin-bottom:20px;
}

.search{
flex:1;
padding:12px;
font-size:16px;
border-radius:8px;
border:1px solid #ccc;
}

.searchBtn{
padding:12px 18px;
border:none;
background:#4c7cff;
color:white;
border-radius:8px;
cursor:pointer;
}

.loginBtn{
padding:12px 18px;
border:none;
background:#222;
color:white;
border-radius:8px;
cursor:pointer;
}

.categories{
margin-bottom:20px;
}

.categories button{
margin-right:8px;
padding:8px 14px;
border:none;
border-radius:8px;
background:#e7ebf4;
cursor:pointer;
}

.categories button.active{
background:#4c7cff;
color:white;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
gap:22px;
}

.card{
background:white;
border-radius:16px;
padding:28px;
text-align:center;
cursor:pointer;
position:relative;
box-shadow:0 4px 12px rgba(0,0,0,0.06);
}

.card:hover{
transform:translateY(-4px);
}

.icon{
font-size:32px;
margin-bottom:10px;
}

.star{
position:absolute;
top:10px;
right:12px;
font-size:18px;
cursor:pointer;
}

.adminBar{
margin-top:30px;
}

.adminBar button{
margin-right:10px;
padding:10px 16px;
}

.modal{
position:fixed;
top:0;
left:0;
right:0;
bottom:0;
background:rgba(0,0,0,.3);
display:none;
align-items:center;
justify-content:center;
}

.modalBox{
background:white;
padding:25px;
border-radius:12px;
width:380px;
}

.modalBox input,
.modalBox select{
width:100%;
padding:10px;
margin-bottom:10px;
}

.iconGrid{
display:grid;
grid-template-columns:repeat(5,1fr);
gap:8px;
margin-bottom:10px;
}

.iconItem{
background:#eee;
padding:8px;
text-align:center;
border-radius:6px;
cursor:pointer;
}

.iconItem.active{
background:#4c7cff;
color:white;
}

</style>
</head>

<body>

<div class="container">

<h1>ÏóÖÎ¨¥ Ìè¨ÌÑ∏</h1>

<div class="user" id="user"></div>

<div class="topbar">
<input id="search" class="search" placeholder="Í≤ÄÏÉâ">
<button class="searchBtn" onclick="render()">Í≤ÄÏÉâ</button>
<button class="loginBtn" onclick="login()">Î°úÍ∑∏Ïù∏</button>
</div>

<div class="categories" id="categories"></div>

<div id="grid" class="grid"></div>

<div id="adminBar" class="adminBar" style="display:none">
<button onclick="openAdd()">ÏÇ¨Ïù¥Ìä∏ Ï∂îÍ∞Ä</button>
<button onclick="addCategory()">Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä</button>
</div>

</div>

<div class="modal" id="modal">
<div class="modalBox">

<input id="siteName" placeholder="ÏÇ¨Ïù¥Ìä∏ Ïù¥Î¶Ñ">
<input id="siteURL" placeholder="URL">

<select id="siteCategory"></select>

<div class="iconGrid" id="iconGrid"></div>

<button onclick="saveSite()">Ï†ÄÏû•</button>
<button onclick="deleteSite()">ÏÇ≠Ï†ú</button>

</div>
</div>

<script>

let currentUser=""
let isAdmin=false
let editingIndex=null
let currentCategory="Ï†ÑÏ≤¥"

let icons=["üìä","üßæ","üè•","üìÅ","‚öôÔ∏è","üåê","üìà","üíæ","üë§","‚≠ê"]

let categories=JSON.parse(localStorage.getItem("portal_categories"))||["Ï†ÑÏ≤¥","ÏóÖÎ¨¥"]

let sites=JSON.parse(localStorage.getItem("portal_sites"))||[
{
name:"ÌôòÏûê ÎÇ¥Ïõê Î∂ÑÏÑù",
url:"https://sdsd824-ux.github.io/visitrate/",
category:"ÏóÖÎ¨¥",
icon:"üìä"
}
]

let favorites=[]

function saveData(){
localStorage.setItem("portal_sites",JSON.stringify(sites))
localStorage.setItem("portal_categories",JSON.stringify(categories))
}

function login(){

let name=prompt("Ïù¥Î¶Ñ")

if(!name) return

currentUser=name
document.getElementById("user").innerText="ÏÇ¨Ïö©Ïûê : "+name

if(name==="ÍπÄÏú§Ïãù"){

let pass=prompt("Í¥ÄÎ¶¨Ïûê ÎπÑÎ∞ÄÎ≤àÌò∏")

if(pass==="ÏßÑÏÑ§ÍπÄÏú§Ïãù"){
isAdmin=true
adminBar.style.display="block"
}

}

favorites=JSON.parse(localStorage.getItem("fav_"+name)||"[]")

render()

}

function render(){

let keyword=search.value.toLowerCase()

let grid=document.getElementById("grid")
grid.innerHTML=""

drawCategories()

let sorted=[...sites].sort((a,b)=>{

let af=favorites.includes(a.url)?0:1
let bf=favorites.includes(b.url)?0:1
return af-bf

})

sorted.forEach((site,i)=>{

if(keyword && !site.name.toLowerCase().includes(keyword)) return

if(currentCategory!=="Ï†ÑÏ≤¥"){
if(site.category!==currentCategory) return
}

let card=document.createElement("div")
card.className="card"

let star=favorites.includes(site.url)?"‚òÖ":"‚òÜ"

card.innerHTML=`
<div class="star">${star}</div>
<div class="icon">${site.icon}</div>
<div><b>${site.name}</b></div>
<div style="font-size:12px;color:#777">${site.category}</div>
`

card.onclick=()=>window.open(site.url)

card.querySelector(".star").onclick=(e)=>{
e.stopPropagation()
toggleFav(site.url)
}

if(isAdmin){
card.oncontextmenu=(e)=>{
e.preventDefault()
editSite(i)
}
}

grid.appendChild(card)

})

}

function toggleFav(url){

if(favorites.includes(url)){
favorites=favorites.filter(f=>f!==url)
}else{
favorites.push(url)
}

localStorage.setItem("fav_"+currentUser,JSON.stringify(favorites))
render()

}

function drawCategories(){

let wrap=document.getElementById("categories")
wrap.innerHTML=""

categories.forEach(cat=>{

let btn=document.createElement("button")
btn.innerText=cat

if(cat===currentCategory) btn.classList.add("active")

btn.onclick=()=>{
currentCategory=cat
render()
}

wrap.appendChild(btn)

})

}

function openAdd(){

editingIndex=null
modal.style.display="flex"

siteName.value=""
siteURL.value=""

drawCategorySelect()
drawIcons()

}

function editSite(i){

editingIndex=i

let s=sites[i]

modal.style.display="flex"

siteName.value=s.name
siteURL.value=s.url

drawCategorySelect(s.category)
drawIcons(s.icon)

}

function drawCategorySelect(selected){

siteCategory.innerHTML=""

categories.forEach(cat=>{

let o=document.createElement("option")
o.value=cat
o.innerText=cat

if(cat===selected) o.selected=true

siteCategory.appendChild(o)

})

}

function drawIcons(selected){

let wrap=document.getElementById("iconGrid")
wrap.innerHTML=""

icons.forEach(icon=>{

let div=document.createElement("div")
div.className="iconItem"
div.innerText=icon

if(icon===selected) div.classList.add("active")

div.onclick=()=>{

document.querySelectorAll(".iconItem")
.forEach(i=>i.classList.remove("active"))

div.classList.add("active")

}

wrap.appendChild(div)

})

}

function getSelectedIcon(){

let active=document.querySelector(".iconItem.active")
return active?active.innerText:"üìä"

}

function saveSite(){

let data={
name:siteName.value,
url:siteURL.value,
category:siteCategory.value,
icon:getSelectedIcon()
}

if(editingIndex===null){
sites.push(data)
}else{
sites[editingIndex]=data
}

saveData()

modal.style.display="none"
render()

}

function deleteSite(){

if(editingIndex===null) return

sites.splice(editingIndex,1)

saveData()

modal.style.display="none"
render()

}

function addCategory(){

let name=prompt("Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶Ñ")

if(!name) return

categories.push(name)

saveData()

render()

}

search.addEventListener("keydown",e=>{
if(e.key==="Enter") render()
})

render()

</script>

</body>
</html>
